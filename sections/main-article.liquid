{{ 'section-blog-post.css' | asset_url | stylesheet_tag }}

<article class="article-template">
  {%- for block in section.blocks -%}
    {%- case block.type -%}
      {%- when '@app' -%}
        <div class="page-width page-width--narrow">
          {% render block %}
        </div>
      {%- when 'featured_image' -%}
        {%- if article.image -%}
          <div
            class="article-template__hero-container{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}"
            {{ block.shopify_attributes }}
          >
            <div
              class="article-template__hero-{{ block.settings.image_height }} media"
              {% if block.settings.image_height == 'adapt' and article.image %}
                style="padding-bottom: {{ 1 | divided_by: article.image.aspect_ratio | times: 100 }}%;"
              {% endif %}
            >
              <img
                srcset="
                  {% if article.image.width >= 350 %}{{ article.image | image_url: width: 350 }} 350w,{% endif %}
                  {% if article.image.width >= 750 %}{{ article.image | image_url: width: 750 }} 750w,{% endif %}
                  {% if article.image.width >= 1100 %}{{ article.image | image_url: width: 1100 }} 1100w,{% endif %}
                  {% if article.image.width >= 1500 %}{{ article.image | image_url: width: 1500 }} 1500w,{% endif %}
                  {% if article.image.width >= 2200 %}{{ article.image | image_url: width: 2200 }} 2200w,{% endif %}
                  {% if article.image.width >= 3000 %}{{ article.image | image_url: width: 3000 }} 3000w,{% endif %}
                  {{ article.image | image_url }} {{ article.image.width }}w
                "
                sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 100 }}px, (min-width: 750px) calc(100vw - 10rem), 100vw"
                src="{{ article.image | image_url: width: 1100 }}"
                loading="eager"
                fetchpriority="high"
                width="{{ article.image.width }}"
                height="{{ article.image.height }}"
                alt="{{ article.image.alt | escape }}"
              >
            </div>
          </div>
        {%- endif -%}

      {%- when 'title' -%}
        <header
          class="page-width page-width--narrow{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}"
          {{ block.shopify_attributes }}
        >
          <h1
            class="article-template__title"
          >
            {{ article.title | escape }}
          </h1>
          {%- if block.settings.blog_show_date -%}
            <span class="circle-divider caption-with-letter-spacing">
              {{- article.published_at | time_tag: format: 'date' -}}
            </span>
          {%- endif -%}
          {%- if block.settings.blog_show_author -%}
            <span class="caption-with-letter-spacing">
              <span>{{ article.author }}</span>
            </span>
          {%- endif -%}
        </header>

      {%- when 'content' -%}
        <div
          class="article-template__content page-width page-width--narrow rte{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
          {{ block.shopify_attributes }}
        >
          {{ article.content }}
        </div>

      {%- when 'share' -%}
        <div
          class="article-template__social-sharing page-width page-width--narrow{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
          {{ block.shopify_attributes }}
        >
          {% assign share_url = request.origin | append: article.url %}
          {% render 'share-button', block: block, share_link: share_url %}
        </div>
    {%- endcase -%}
  {%- endfor -%}

  <div class="article-template__back element-margin-top center{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
          <a href="{{ blog.url }}" class="full-unstyled-link button norwesterLarge button--primary" style="position: relative;">
                 <div class="spacer"></div>
            <svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 153 29" class="buttonBorder">
              <!-- Generator: Adobe Illustrator 29.3.1, SVG Export Plug-In . SVG Version: 2.1.0 Build 151)  -->
              <defs>
                <style>
                  .st0 {
                    fill-rule: evenodd;
                  }
                </style>
              </defs>
              <path class="st0" d="M151.1,14c-1.3-1-1.3-3.3-1.3-5.2,0-.4,0-.8,0-1.2C149.6,1.5,146.3,0,140.2,0H12.8c-6.1,0-9.4,1.5-9.6,7.7,0,.4,0,.8,0,1.2,0,1.9,0,4.2-1.3,5.2-.3.3-.8.4-1.4.5.6,0,1,.2,1.4.5,1.3,1,1.3,3.3,1.3,5.1,0,.4,0,.8,0,1.2.2,5.2,2.5,7.1,6.9,7.6.8,0,1.8.1,2.8.1h127.4c1,0,1.9,0,2.8-.1,4.4-.5,6.8-2.4,6.9-7.6,0-.4,0-.8,0-1.2,0-1.9,0-4.2,1.3-5.1.3-.3.8-.4,1.4-.5-.6,0-1-.2-1.4-.5ZM150.2,14.8c-.5.6-.8,1.4-.9,2.1-.1.8-.2,1.6-.2,2.3,0,.3,0,.6,0,.9h0c0,.4,0,.8,0,1.1-.1,2.9-.9,4.6-2.3,5.5-1.4,1-3.5,1.4-6.6,1.4H12.8c-3.1,0-5.2-.4-6.6-1.4-1.3-.9-2.2-2.6-2.3-5.5,0-.4,0-.7,0-1.1,0-.3,0-.6,0-.9,0-.7,0-1.6-.2-2.3-.1-.8-.4-1.5-.9-2.1,0,0-.2-.2-.3-.3,0,0,.2-.2.3-.3.5-.6.8-1.4.9-2.1.1-.8.2-1.6.2-2.3,0-.3,0-.6,0-.9,0-.4,0-.8,0-1.1.1-2.9.9-4.6,2.3-5.5,1.4-1,3.5-1.4,6.6-1.4h127.4c3,0,5.2.4,6.6,1.4,1.3.9,2.2,2.6,2.3,5.5,0,.4,0,.7,0,1.1h0c0,.3,0,.6,0,.9,0,.7,0,1.6.2,2.3.1.8.4,1.5.9,2.1,0,0,.2.2.3.3,0,0-.2.2-.3.3Z"/>
            </svg>
            <svg
              width="26"
              height="15"
              viewBox="0 0 26 15"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              class="buttonDetail buttonDetail-left"
            >
              <path d="M10.767 9.20681C11.9295 8.36314 12.8023 7.90453 13.438 7.65359L9.78886 7.65359C8.94239 9.14191 7.50153 8.60975 7.50153 8.60975C4.36398 7.77906 -1.29886e-06 7.42861 -1.29886e-06 7.42861C3.93134 6.99596 6.45568 6.37294 7.7724 6.01817C8.84082 5.73262 9.56689 6.88347 9.80014 7.32478L13.3854 7.32478C12.7534 7.06951 11.8956 6.6109 10.767 5.79319C7.79121 3.62994 6.15095 0.74416 5.95156 1.0406e-06C5.95156 1.0406e-06 7.82883 2.40554 11.147 3.48284C11.147 3.48284 13.8143 4.06259 12.3019 6.15662C12.3019 6.15662 12.9527 7.07384 14.356 7.35506C14.4275 6.93972 14.736 6.62388 15.1159 6.59792L15.1159 5.90568C15.1159 5.90568 13.7465 5.46871 14.0513 4.1448C14.3597 2.81656 15.0256 2.34064 15.1874 0.35045C15.1874 0.35045 15.8909 1.53159 15.9812 3.40064C16.0715 5.26536 15.2777 5.82781 15.2777 5.82781L15.2777 6.60658C15.684 6.66715 16 7.06519 16 7.54976C16 8.03432 15.684 8.42804 15.2777 8.49293L15.2777 9.16787C15.2777 9.16787 16.0715 9.73031 15.9812 11.595C15.8909 13.4598 15.1874 14.6452 15.1874 14.6452C15.0256 12.655 14.3597 12.1791 14.0513 10.8509C13.7465 9.52264 15.1159 9.08999 15.1159 9.08999L15.1159 8.50591C14.7096 8.47563 14.3861 8.10787 14.3485 7.64494C12.949 7.93049 12.3019 8.84338 12.3019 8.84338C13.818 10.9374 11.147 11.5172 11.147 11.5172C7.82883 12.5945 5.95156 15 5.95156 15C6.15095 14.2515 7.79121 11.3701 10.767 9.21113L10.767 9.20681Z" fill="black"/>
              <ellipse cx="25" cy="7.5" rx="1" ry="1" fill="black"/>
            </svg>
                      <span>BACK TO CAPTAIN&apos;s JOURNAL </span>
                      <svg
              width="26"
              height="15"
              viewBox="0 0 26 15"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              class="buttonDetail buttonDetail-right"
            >
              <ellipse cx="1" cy="7.5" rx="1" ry="1" transform="rotate(-180 1 7.5)" fill="black"/>
              <path d="M15.233 5.79319C14.0705 6.63686 13.1977 7.09547 12.562 7.34641L16.2111 7.34641C17.0576 5.85809 18.4985 6.39025 18.4985 6.39025C21.636 7.22094 26 7.57139 26 7.57139C22.0687 8.00404 19.5443 8.62706 18.2276 8.98183C17.1592 9.26738 16.4331 8.11653 16.1999 7.67522L12.6146 7.67522C13.2466 7.93049 14.1044 8.3891 15.233 9.20681C18.2088 11.3701 19.849 14.2558 20.0484 15C20.0484 15 18.1712 12.5945 14.853 11.5172C14.853 11.5172 12.1857 10.9374 13.6981 8.84338C13.6981 8.84338 13.0473 7.92616 11.644 7.64494C11.5725 8.06028 11.264 8.37612 10.8841 8.40208L10.8841 9.09432C10.8841 9.09432 12.2535 9.53129 11.9487 10.8552C11.6403 12.1834 10.9744 12.6594 10.8126 14.6496C10.8126 14.6496 10.1091 13.4684 10.0188 11.5994C9.92852 9.73464 10.7223 9.17219 10.7223 9.17219L10.7223 8.39342C10.316 8.33285 10 7.93481 10 7.45024C10 6.96568 10.316 6.57196 10.7223 6.50707L10.7223 5.83213C10.7223 5.83213 9.92852 5.26969 10.0188 3.40496C10.1091 1.54024 10.8126 0.354774 10.8126 0.354774C10.9744 2.34497 11.6403 2.82088 11.9487 4.14912C12.2535 5.47736 10.8841 5.91001 10.8841 5.91001L10.8841 6.49409C11.2904 6.52437 11.6139 6.89212 11.6515 7.35506C13.051 7.06951 13.6981 6.15662 13.6981 6.15662C12.182 4.06259 14.853 3.48284 14.853 3.48284C18.1712 2.40554 20.0484 4.33372e-07 20.0484 4.33372e-07C19.849 0.748486 18.2088 3.62994 15.233 5.78887L15.233 5.79319Z" fill="black"/>
            </svg>
            </a>
  </div>
  {%- if blog.comments_enabled? -%}
    <div class="article-template__comment-wrapper background-secondary">
      <div
        id="comments"
        class="page-width page-width--narrow{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
      >
        {%- if article.comments_count > 0 -%}
          {%- assign anchorId = '#Comments-' | append: article.id -%}

          <h2 id="Comments-{{ article.id }}" tabindex="-1">
            {{ 'blogs.article.comments' | t: count: article.comments_count }}
          </h2>
          {% paginate article.comments by 5 %}
            <div class="article-template__comments">
              {%- if comment.status == 'pending' and comment.content -%}
                <article id="{{ comment.id }}" class="article-template__comments-comment">
                  {{ comment.content }}
                  <footer class="right">
                    <span class="circle-divider caption-with-letter-spacing">{{ comment.author }}</span>
                  </footer>
                </article>
              {%- endif -%}

              {%- for comment in article.comments -%}
                <article id="{{ comment.id }}" class="article-template__comments-comment">
                  {{ comment.content }}
                  <footer class="right">
                    <span class="circle-divider caption-with-letter-spacing">{{ comment.author }}</span
                    ><span class="caption-with-letter-spacing">
                      {{- comment.created_at | time_tag: format: 'date' -}}
                    </span>
                  </footer>
                </article>
              {%- endfor -%}
              {% render 'pagination', paginate: paginate, anchor: anchorId %}
            </div>
          {% endpaginate %}
        {%- endif -%}
        {% form 'new_comment', article %}
          {%- liquid
            assign post_message = 'blogs.article.success'
            if blog.moderated? and comment.status == 'unapproved'
              assign post_message = 'blogs.article.success_moderated'
            endif
          -%}
          <h2>{{ 'blogs.article.comment_form_title' | t }}</h2>
          {%- if form.errors -%}
            <div class="form__message" role="alert">
              <h3 class="form-status caption-large text-body" tabindex="-1" autofocus>
                <span class="svg-wrapper">
                  {{- 'icon-error.svg' | inline_asset_content -}}
                </span>
                {{ 'templates.contact.form.error_heading' | t }}
              </h3>
            </div>
            <ul class="form-status-list caption-large">
              {%- for field in form.errors -%}
                <li>
                  <a href="#CommentForm-{{ field }}" class="link">
                    {%- if form.errors.translated_fields[field] contains 'author' -%}
                      {{ 'blogs.article.name' | t }}
                    {%- elsif form.errors.translated_fields[field] contains 'body' -%}
                      {{ 'blogs.article.message' | t }}
                    {%- else -%}
                      {{ form.errors.translated_fields[field] }}
                    {%- endif -%}
                    {{ form.errors.messages[field] }}
                  </a>
                </li>
              {%- endfor -%}
            </ul>
          {%- elsif form.posted_successfully? -%}
            <div class="form-status-list form__message" role="status">
              <h3 class="form-status" tabindex="-1" autofocus>
                <span class="svg-wrapper">
                  {{- 'icon-success.svg' | inline_asset_content -}}
                </span>
                {{ post_message | t }}
              </h3>
            </div>
          {%- endif -%}

          <div
            {% if blog.moderated? == false %}
              class="article-template__comments-fields"
            {% endif %}
          >
            <div class="article-template__comment-fields">
              <div class="field field--with-error">
                <input
                  type="text"
                  name="comment[author]"
                  id="CommentForm-author"
                  class="field__input"
                  autocomplete="name"
                  value="{{ form.author }}"
                  aria-required="true"
                  required
                  {% if form.errors contains 'author' %}
                    aria-invalid="true"
                    aria-describedby="CommentForm-author-error"
                  {% endif %}
                  placeholder="{{ 'blogs.article.name' | t }}"
                >
                <label class="field__label" for="CommentForm-author">
                  {{- 'blogs.article.name' | t }}
                  <span aria-hidden="true">*</span></label
                >
                {%- if form.errors contains 'author' -%}
                  <small id="CommentForm-author-error">
                    <span class="form__message">
                      <span class="svg-wrapper">
                        {{- 'icon-error.svg' | inline_asset_content -}}
                      </span>
                      {{- 'blogs.article.name' | t }}
                      {{ form.errors.messages.author }}.</span
                    >
                  </small>
                {%- endif -%}
              </div>
              <div class="field field--with-error">
                <input
                  type="email"
                  name="comment[email]"
                  id="CommentForm-email"
                  autocomplete="email"
                  class="field__input"
                  value="{{ form.email }}"
                  autocorrect="off"
                  autocapitalize="off"
                  aria-required="true"
                  required
                  {% if form.errors contains 'email' %}
                    aria-invalid="true"
                    aria-describedby="CommentForm-email-error"
                  {% endif %}
                  placeholder="{{ 'blogs.article.email' | t }}"
                >
                <label class="field__label" for="CommentForm-email">
                  {{- 'blogs.article.email' | t }}
                  <span aria-hidden="true">*</span></label
                >
                {%- if form.errors contains 'email' -%}
                  <small id="CommentForm-email-error">
                    <span class="form__message">
                      <span class="svg-wrapper">
                        {{- 'icon-error.svg' | inline_asset_content -}}
                      </span>
                      {{- 'blogs.article.email' | t }}
                      {{ form.errors.messages.email }}.</span
                    >
                  </small>
                {%- endif -%}
              </div>
            </div>
            <div class="field field--with-error">
              <textarea
                rows="5"
                name="comment[body]"
                id="CommentForm-body"
                class="text-area field__input"
                aria-required="true"
                required
                {% if form.errors contains 'body' %}
                  aria-invalid="true"
                  aria-describedby="CommentForm-body-error"
                {% endif %}
                placeholder="{{ 'blogs.article.message' | t }}"
              >{{ form.body }}</textarea>
              <label class="form__label field__label" for="CommentForm-body">
                {{- 'blogs.article.message' | t }}
                <span aria-hidden="true">*</span></label
              >
            </div>
            {%- if form.errors contains 'body' -%}
              <small id="CommentForm-body-error">
                <span class="form__message">
                  <span class="svg-wrapper">
                    {{- 'icon-error.svg' | inline_asset_content -}}
                  </span>
                  {{- 'blogs.article.message' | t }}
                  {{ form.errors.messages.body }}.</span
                >
              </small>
            {%- endif -%}
          </div>
          {%- if blog.moderated? -%}
            <p class="article-template__comment-warning caption">{{ 'blogs.article.moderated' | t }}</p>
          {%- endif -%}
          <input type="submit" class="button" value="{{ 'blogs.article.post' | t }}">
        {% endform %}
      </div>
    </div>
  {%- endif -%}
</article>

<script type="application/ld+json">
  {{ article | structured_data }}
</script>

{% schema %}
{
  "name": "t:sections.main-article.name",
  "tag": "section",
  "class": "section",
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "featured_image",
      "name": "t:sections.main-article.blocks.featured_image.name",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "image_height",
          "options": [
            {
              "value": "adapt",
              "label": "t:sections.main-article.blocks.featured_image.settings.image_height.options__1.label"
            },
            {
              "value": "small",
              "label": "t:sections.main-article.blocks.featured_image.settings.image_height.options__2.label"
            },
            {
              "value": "medium",
              "label": "t:sections.main-article.blocks.featured_image.settings.image_height.options__3.label"
            },
            {
              "value": "large",
              "label": "t:sections.main-article.blocks.featured_image.settings.image_height.options__4.label"
            }
          ],
          "default": "adapt",
          "label": "t:sections.main-article.blocks.featured_image.settings.image_height.label"
        }
      ]
    },
    {
      "type": "title",
      "name": "t:sections.main-article.blocks.title.name",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "blog_show_date",
          "default": true,
          "label": "t:sections.main-article.blocks.title.settings.blog_show_date.label"
        },
        {
          "type": "checkbox",
          "id": "blog_show_author",
          "default": false,
          "label": "t:sections.main-article.blocks.title.settings.blog_show_author.label"
        }
      ]
    },
    {
      "type": "content",
      "name": "t:sections.main-article.blocks.content.name",
      "limit": 1
    },
    {
      "type": "share",
      "name": "t:sections.main-article.blocks.share.name",
      "limit": 2,
      "settings": [
        {
          "type": "text",
          "id": "share_label",
          "label": "t:sections.main-article.blocks.share.settings.text.label",
          "default": "t:sections.main-article.blocks.share.settings.text.default"
        }
      ]
    }
  ]
}
{% endschema %}
