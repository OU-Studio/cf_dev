<!doctype html>
<html class="js" lang="{{ request.locale.iso_code }}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="">
    <link rel="canonical" href="{{ canonical_url }}">

    <link rel="stylesheet" href="https://use.typekit.net/wlt3jps.css">


<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@dearhive/dearflip-jquery-flipbook@1.7.3/dflip/js/dflip.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@dearhive/dearflip-jquery-flipbook@1.7.3/dflip/css/dflip.min.css">





<script>
  (function ($, DFLIP) {
    if (!$ || !DFLIP) return;
    if ($.fn.dearflip) return;

    // work out which constructor exists
    const BookCtor = DFLIP.Book || DFLIP.DFLIPBook;
    if (typeof BookCtor !== 'function') {
      console.error('DearFlip: no constructor found on DFLIP – check build.');
      return;
    }

    $.fn.dearflip = function (options) {
      return this.each(function () {
        new BookCtor(this, options || {});
      });
    };

    console.log('✅ DearFlip attached to jQuery using', BookCtor.name);
  })(window.jQuery, window.DFLIP);
</script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js" integrity="sha512-XtmMtDEcNz2j7ekrtHvOVR4iwwaD6o/FUJe6+Zq+HgcCsk3kj4uSQQR8weQ2QVj1o0Pk6PwYLohm206ZzNfubg==" crossorigin="anonymous" referrerpolicy="no-referrer" ></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.0/nouislider.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.0/nouislider.min.js"></script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"
      integrity="sha512-17EgCFERpgZKcm0j0fEq1YCJuyAWdz9KUtv1EjVuaOz8pDnh/0nZxmU6BBXwaaxqoi9PQXnRWqlcDB027hgv9A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    >
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"
      integrity="sha512-yHknP1/AwR+yx26cB1y0cjvQUMvEa2PFzt1c9LlS4pRQ5NOTZFWbhBig+X9G9eYW/8m0/4OXNx8pxJ6z57x0dw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    >

    <script>
      // Ensure jQuery + Slick loaded before this file.
(function ($, win, doc) {
  'use strict';

  // ---------- Helpers ----------
  const hasSlick = typeof $.fn.slick === 'function';

  const DOT_SVG = `
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 141.73 42.52" aria-hidden="true" focusable="false">
      <path d="M138.41,4.06c-.43-.56-.93-1.05-1.48-1.47-1.47-1.33-3.51-2.02-5.62-1.7-2.24.33-4.06,1.72-5.05,3.58-.29.49-.52,1.01-.68,1.55-.58,2.01-.14,4.03,1.18,5.67,1.46,2.01,3.95,3.15,6.57,2.76,1.3-.19,2.46-.74,3.4-1.53-.27,2.22-1.03,4.29-2.32,6.32-4.31,5.52-9.5,8.87-15,9.7-8.64,1.29-15.98-3.71-19.42-9.25-7.42-11.94-13.07-12.29-17.79-11.68-4.79.96-8.93,3.81-11.38,7.81-2.45-4.01-6.59-6.85-11.38-7.81-4.72-.61-10.37-.26-17.79,11.68-3.44,5.54-10.78,10.54-19.42,9.25-5.5-.82-10.69-4.18-15-9.7-1.29-2.03-2.05-4.1-2.32-6.32.94.79,2.1,1.34,3.4,1.53,2.62.39,5.11-.75,6.57-2.76,1.32-1.64,1.76-3.66,1.18-5.67-.16-.54-.39-1.06-.68-1.55-.98-1.86-2.81-3.24-5.05-3.58-2.12-.32-4.15.37-5.62,1.7-.55.42-1.05.91-1.48,1.47-1.72,2.22-2.36,5.36-1.91,9.31.43,3.82,1.62,6.59,3.55,10.1,6.38,9.51,16.22,15.31,29.22,17.26,12.91,1.93,24.16-.78,24.27-.81,1.66-.41,9.47-3.24,12.46-8.77,2.99,5.52,10.8,8.36,12.46,8.77.11.03,11.36,2.74,24.27.81,13.01-1.95,22.84-7.75,29.22-17.26,1.92-3.51,3.12-6.29,3.55-10.1.45-3.96-.2-7.09-1.91-9.31Z"/>
    </svg>
  `;

  const slickDots = {
    dots: true,
    dotsClass: 'slick-dots ou-dots',
    customPaging: (_slick, i) => `
      <button type="button" class="ou-dot" aria-label="Go to slide ${i + 1}">
        ${DOT_SVG}
      </button>
    `
  };

  const initSlickOnce = ($el, opts) => {
    if (!hasSlick || !$el.length) return;
    $el.filter(':not(.slick-initialized)').slick(opts);
  };

  // ---------- Lightbox: Museum visit ----------
  const appendMatterportOnce = () => {
    if (doc.querySelector('.lbCover')) return; // already open

    const wrap = doc.createElement('div');
    wrap.className = 'lbWrap';
    wrap.innerHTML = `
      <div class="lbCover" role="button" aria-label="Close"></div>
      <div class="lbClose" aria-label="Close"></div>
      <div class="embed-container" role="dialog" aria-modal="true" aria-label="Museum tour">
        <iframe width="853" height="480"
          src="https://my.matterport.com/show/?m=E9G6257KNrd"
          frameborder="0" allowfullscreen
          allow="xr-spatial-tracking"></iframe>
      </div>
      <style>
        .lbWrap{position:fixed;inset:0;z-index:9999}
        .embed-container{position:absolute;inset:10% 5%;max-width:1200px;margin:auto;left:0;right:0;background:#000}
        .embed-container{position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%}
        .embed-container iframe{position:absolute;top:0;left:0;width:100%;height:100%}
      </style>
    `;
    doc.body.appendChild(wrap);

    const close = () => wrap.remove();
    wrap.querySelector('.lbCover')?.addEventListener('click', close);
    wrap.querySelector('.lbClose')?.addEventListener('click', close);
    doc.addEventListener('keydown', (e) => (e.key === 'Escape') && close(), { once: true });
  };

  const initMuseum = () => {
    const $btn = $('#visit-museum');
    if ($btn.length) {
      $btn.off('click.ouMuseum').on('click.ouMuseum', (e) => {
        e.preventDefault();
        appendMatterportOnce();
      });
    }
  };

  document.addEventListener('click', (e) => {
  const btn = e.target.closest('.shuffle');
  if (!btn) return;

  const container = btn.parentElement.querySelector('.custom-image-links');
  if (!container) return;

  const items = Array.from(container.children);
  const original = [...items];
  let shuffled = [];

  // Derangement shuffle (no element stays in same position)
  do {
    shuffled = [...original];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
  } while (shuffled.some((item, i) => item === original[i]));

  // Re-append in new order
  shuffled.forEach(item => container.appendChild(item));

  // Smooth scroll to #cardTop after short delay
  const target = document.querySelector('#cardTop');
  if (target) {
    setTimeout(() => {
      target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 150); // small delay to allow DOM update
  }
});




  // ---------- Notes sliders ----------
  const initNotesSliders = () => {
    const $labels = $('.inline-richtext');
    if (!$labels.length) return;

    $labels.each(function () {
      const txt = $(this).text().trim();
      if (txt === 'TOP NOTES' || txt === 'Expedition Mug') {
        const $ul = $(this).closest('ul').addClass('notesSlider');
        if (!hasSlick) return;

        // mobile-only for TOP NOTES; always for Expedition Mug (preserving your logic)
        const shouldInit =
          (txt === 'TOP NOTES' && win.innerWidth < 900) || (txt === 'Expedition Mug');

        if (shouldInit) {
          initSlickOnce($ul, {
            slidesToShow: 1,
            slidesToScroll: 1,
            centerMode: false,
            swipeToSlide: true,
            infinite: false,
            arrows: false,
            dots: false
          });
        }
      }
    });
  };

  // ---------- Collapsible rows ----------
  const initCollapsibles = () => {
    const $rows = $('.collapsible-row');
    if (!$rows.length) return;

    // start collapsed
    $rows.find('.collapsible-content').each(function () {
      $(this).stop(true, true).slideUp(0);
    });

    // delegate clicks on h2 inside .collapsible-row
    $(doc).off('click.ouCollapse', '.collapsible-row h2')
      .on('click.ouCollapse', '.collapsible-row h2', function () {
        $(this).next('.collapsible-content').stop(true, true).slideToggle(300);
      });
  };

  // Helper: wires events so the slider's PARENT gets data-slide / data-total
function wireParentData($els, parentSelector) {
  $els.on('init reInit afterChange', function (event, slick, currentSlide) {
    const index = (typeof currentSlide === 'number') ? currentSlide : (slick?.currentSlide ?? 0);
    const total = slick?.slideCount ?? $(this).children().length;
    const $parent = parentSelector
      ? $(this).closest(parentSelector)
      : $(this).parent(); // default: immediate parent

    $parent.attr({
      'data-slide': index + 1,   // 1-based for humans
      'data-total': total
    });
  });
}


  // ---------- Slideshows ----------
  const initSlideshows = () => {
    if (!hasSlick) return;

  const $nonFB   = $('.section:not(.full-bleed) .slideshow-container');
  const $fullBleed = $('.full-bleed .slideshow-container');

  // Bind BEFORE init so we catch the 'init' event
  wireParentData($nonFB);      // parent will be the immediate parent of .slideshow-container
  wireParentData($fullBleed);  // same here; pass a selector if you want a specific ancestor

  // Non full-bleed
  initSlickOnce($nonFB, {
    slidesToShow: 1,
    slidesToScroll: 1,
    centerMode: true,
    swipeToSlide: true,
    infinite: true,
    arrows: true,
    ...slickDots
  });

  // Full-bleed (autoplay, no arrows)
  initSlickOnce($fullBleed, {
    slidesToShow: 1,
    slidesToScroll: 1,
    centerMode: true,
    swipeToSlide: true,
    infinite: true,
    arrows: false,
    autoplay: true,
    autoplaySpeed: 5000,
    ...slickDots
  });
  };

  // ---------- Product media + buy block ----------
  const initProductMedia = () => {
    const $media = $('.product__media-list');
    if (!$media.length) return;

    initSlickOnce($media, {
      slidesToShow: 1,
      slidesToScroll: 1,
      centerMode: true,
      swipeToSlide: true,
      infinite: true,
      arrows: true,
      dots: true
    });

    // Group buy buttons + qty input
    const $formInput = $('.product-form__input').first();
    const $buyButtons = $('.prodBuyButtons').first();

    if ($formInput.length || $buyButtons.length) {
      const $wrap = $('<div class="qandb"></div>');
      $wrap.insertBefore($formInput.length ? $formInput : $buyButtons);
      if ($buyButtons.length) $buyButtons.prependTo($wrap);
      if ($formInput.length) $formInput.prependTo($wrap);
    }
  };

  // ---------- Boot ----------
  // Use window load for image-dependent slick sizing; move light DOM work to DOMContentLoaded if desired.
  $(win).on('load', function () {
    initMuseum();
    initNotesSliders();
    initCollapsibles();
    initSlideshows();
    initProductMedia();
  });

  // --- Config ---
const ADDED_LABEL = 'ADDED!';
const REVERT_LABEL = 'ADD TO CART';
const ASSERT_MS = 600;   // keep re-applying for 0.6s to survive re-renders
const REVERT_MS = 2000;  // time to show ADDED! before reverting

// Prefer a stable card/section ancestor so if the button swaps, we can find the new one.
function findCard(el) {
  return el.closest('[data-product-id], .product-card, .card--product, .grid-product, .product-item, .product, .card');
}

// Current live button inside a card (handles PDP + quick add buttons)
function findLiveButton(card) {
  if (!card) return null;
  return (
    card.querySelector('.product-form__submit') ||
    card.querySelector('.quick-add__submit') ||
    card.querySelector('button[name="add"]') ||
    card.querySelector('button[type="submit"]')
  );
}

// Best-effort to find the visible label span/element inside the button
function findButtonLabelEl(btn) {
  if (!btn) return null;
  return (
    btn.querySelector('[data-add-to-cart-text]') ||
    btn.querySelector('.button__text') ||
    btn.querySelector('.text') ||
    btn.querySelector('span:not(.loading-overlay__spinner)') ||
    btn // fallback: set on the button
  );
}

// Re-apply label repeatedly until deadline to beat DOM swaps
function assertLabel(card, label, durationMs) {
  const deadline = performance.now() + durationMs;

  const tick = () => {
    const btn = findLiveButton(card);
    const target = findButtonLabelEl(btn);
    if (target) target.textContent = label;
    if (performance.now() < deadline) requestAnimationFrame(tick);
  };
  tick();
}

// Flash "ADDED!" then revert
function flashAddedForCard(card) {
  // Show ADDED! (survive swaps for ASSERT_MS)
  assertLabel(card, ADDED_LABEL, ASSERT_MS);

  // Then revert after REVERT_MS (also survive short swaps)
  setTimeout(() => {
    assertLabel(card, REVERT_LABEL, Math.min(ASSERT_MS, 300));
  }, REVERT_MS);
}

// Delegated click handler for both PDP + grid cards
document.addEventListener('click', (e) => {
  const btn = e.target.closest('.product-form__submit, .quick-add__submit, button[name="add"]');
  if (!btn) return;

  const card = findCard(btn) || document;
  // Slight delay so we run after the theme toggles loading / swaps nodes
  setTimeout(() => flashAddedForCard(card), 250);
});

(function () {
  function initBlogLoadMore(scope) {
    const container = (scope || document).querySelector('.main-blog');
    if (!container) return;

    const list = container.querySelector('.blog-articles');
    const btn  = container.querySelector('#blog-load-more');
    if (!list || !btn) return;

    const BATCH = parseInt(btn.dataset.batch || '4', 10);
    let nextURL = btn.dataset.nextUrl || '';
    let queue = [];          // holds article elements waiting to be appended
    let fetching = false;

    // Append up to N articles from queue
    function appendBatch(n) {
      const frag = document.createDocumentFragment();
      for (let i = 0; i < n && queue.length; i++) {
        frag.appendChild(queue.shift());
      }
      if (frag.childNodes.length) list.appendChild(frag);
    }

    // Parse the next page HTML and extract articles + new nextURL
    function extractFromHTML(html) {
      const doc = new DOMParser().parseFromString(html, 'text/html');
      const nextBtn = doc.querySelector('#blog-load-more');
      nextURL = nextBtn ? (nextBtn.getAttribute('data-next-url') || '') : '';
      const nodes = Array.from(doc.querySelectorAll('.blog-articles .blog-articles__article'));
      return nodes;
    }

    async function ensureQueueHasAtLeast(n) {
      if (queue.length >= n || !nextURL || fetching) return;
      fetching = true;
      try {
        const res = await fetch(nextURL, { credentials: 'same-origin' });
        if (!res.ok) throw new Error('Fetch failed: ' + res.status);
        const html = await res.text();
        const newArticles = extractFromHTML(html);
        queue = queue.concat(newArticles);
      } catch (e) {
        console.warn('Blog load-more fetch error:', e);
      } finally {
        fetching = false;
      }
    }

    async function onClick() {
      // If not enough in queue, fetch next page first
      if (queue.length < BATCH && nextURL) {
        await ensureQueueHasAtLeast(BATCH);
      }
      // Append up to BATCH articles
      appendBatch(BATCH);

      // If nothing left to fetch and queue empty, hide button
      if (!nextURL && queue.length === 0) {
        btn.style.display = 'none';
      }
    }

    btn.addEventListener('click', onClick, { passive: true });
  }

  // Init on load
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => initBlogLoadMore());
  } else {
    initBlogLoadMore();
  }

  // Re-init inside Shopify theme editor
  document.addEventListener('shopify:section:load', (e) => {
    initBlogLoadMore(e.target);
  });

})();





})(jQuery, window, document);

    </script>

    {%- if settings.favicon != blank -%}
      <link rel="icon" type="image/png" href="{{ settings.favicon | image_url: width: 32, height: 32 }}">
    {%- endif -%}

    <title>
      {{ page_title }}
      {%- if current_tags %} &ndash; tagged "{{ current_tags | join: ', ' }}"{% endif -%}
      {%- if current_page != 1 %} &ndash; Page {{ current_page }}{% endif -%}
      {%- unless page_title contains shop.name %} &ndash; {{ shop.name }}{% endunless -%}
    </title>

    {% if page_description %}
      <meta name="description" content="{{ page_description | escape }}">
    {% endif %}

    {% render 'meta-tags' %}

    <script src="{{ 'constants.js' | asset_url }}" defer="defer"></script>
    <script src="{{ 'pubsub.js' | asset_url }}" defer="defer"></script>
    <script src="{{ 'global.js' | asset_url }}" defer="defer"></script>
    <script src="{{ 'details-disclosure.js' | asset_url }}" defer="defer"></script>
    <script src="{{ 'details-modal.js' | asset_url }}" defer="defer"></script>
    <script src="{{ 'search-form.js' | asset_url }}" defer="defer"></script>

    {%- if settings.animations_reveal_on_scroll -%}

    {%- endif -%}

    {{ content_for_header }}


    <link rel="stylesheet" href="{{ 'base.css' | asset_url }}?t={{ 'now' | date: '%s' }}">


    <style>
      :root {
        --empera-large-size: {{ settings.empera_large_size }}px;
        --empera-large-line-height: {{ settings.empera_large_line_height }}em;
        --empera-large-letter-spacing: {{ settings.empera_large_letter_spacing }}px;
        --empera-large-weight: {{ settings.empera_large_weight }};
        --empera-large-style: {{ settings.empera_large_style }};

  /*font-feature-settings: 'swsh' on;*/

        --garamond-large-size: {{ settings.garamond_large_size }}px;
        --garamond-large-line-height: {{ settings.garamond_large_line_height }}em;
        --garamond-large-letter-spacing: {{ settings.garamond_large_letter_spacing }}px;
        --garamond-large-weight: {{ settings.garamond_large_weight }};
        --garamond-large-style: {{ settings.garamond_large_style }};

        --empera-small-size: {{ settings.empera_small_size }}px;
        --empera-small-line-height: {{ settings.empera_small_line_height }}em;
        --empera-small-letter-spacing: {{ settings.empera_small_letter_spacing }}px;
        --empera-small-weight: {{ settings.empera_small_weight }};
        --empera-small-style: {{ settings.empera_small_style }};

        --garamond-small-size: {{ settings.garamond_small_size }}px;
        --garamond-small-line-height: {{ settings.garamond_small_line_height }}em;
        --garamond-small-letter-spacing: {{ settings.garamond_small_letter_spacing }}px;
        --garamond-small-weight: {{ settings.garamond_small_weight }};
        --garamond-small-style: {{ settings.garamond_small_style }};

        --garamond-tiny-size: {{ settings.garamond_tiny_size }}px;
        --garamond-tiny-line-height: {{ settings.garamond_tiny_line_height }}em;
        --garamond-tiny-letter-spacing: {{ settings.garamond_tiny_letter_spacing }}px;
        --garamond-tiny-weight: {{ settings.garamond_tiny_weight }};
        --garamond-tiny-style: {{ settings.garamond_tiny_style }};

        --norwester-large-size: {{ settings.norwester_large_size }}px;
        --norwester-large-line-height: {{ settings.norwester_large_line_height }}em;
        --norwester-large-letter-spacing: {{ settings.norwester_large_letter_spacing }}px;
        --norwester-large-weight: {{ settings.norwester_large_weight }};
        --norwester-large-style: {{ settings.norwester_large_style }};

        --norwester-small-size: {{ settings.norwester_small_size }}px;
        --norwester-small-line-height: {{ settings.norwester_small_line_height }}em;
        --norwester-small-letter-spacing: {{ settings.norwester_small_letter_spacing }}px;
        --norwester-small-weight: {{ settings.norwester_small_weight }};
        --norwester-small-style: {{ settings.norwester_small_style }};

        --red: #A30000;
        --black: #000000;
        --grey: #000000;
      
        /*
            --cream:rgb(43, 206, 218);
        --offwhite:rgb(91, 129, 40);            
*/
        
        --white: #ffffff;
        
        --cream: #FFFDF3;
        --offwhite: #FAF6EC;
        

      }
    </style>

    <link rel="stylesheet" href="{{ 'component-cart-items.css' | asset_url }}" media="print" onload="this.media='all'">

    {%- if settings.cart_type == 'drawer' -%}
      {{ 'component-cart-drawer.css' | asset_url | stylesheet_tag }}
      {{ 'component-cart.css' | asset_url | stylesheet_tag }}
      {{ 'component-totals.css' | asset_url | stylesheet_tag }}
      {{ 'component-price.css' | asset_url | stylesheet_tag }}
      {{ 'component-discounts.css' | asset_url | stylesheet_tag }}
    {%- endif -%}

    {%- if localization.available_countries.size > 1 or localization.available_languages.size > 1 -%}
      {{ 'component-localization-form.css' | asset_url | stylesheet_tag: preload: true }}
      <script src="{{ 'localization-form.js' | asset_url }}" defer="defer"></script>
    {%- endif -%}

    {%- if settings.predictive_search_enabled -%}
      <link
        rel="stylesheet"
        href="{{ 'component-predictive-search.css' | asset_url }}"
        media="print"
        onload="this.media='all'"
      >
    {%- endif -%}

    <script>
      if (Shopify.designMode) {
        document.documentElement.classList.add('shopify-design-mode');
      }
    </script>


  </head>

  <body class="gradient{% if settings.animations_hover_elements != 'none' %} animate--hover-{{ settings.animations_hover_elements }}{% endif %}" data-url="{{ request.path }}" data-template="{{ template }}">
  

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3296.86 2511.8" id="paperplane" style="position:absolute;left:-9999px;top:-9999px;">
  <defs>
    <style>
      .cls-99 {
        fill: #a30000;
      }
    </style>
  </defs>
  <g id="Layer_2" data-name="Layer 2">
    <polygon class="cls-99" points="161.08 1242.78 3095.92 129.56 2051.54 2165.43 1520.1 1890.46 1065.27 2376.95 830.91 1549.38 161.08 1242.78"/>
  </g>
  <g id="Layer_1" data-name="Layer 1">
    <g>
      <path d="M3134.69,127c-1.64,5.91-2.64,11.63-4.82,16.85-3.42,8.2-7.58,16.09-11.51,24.07-36.98,75.12-73.72,150.36-111.07,225.29-27.31,54.8-55.38,109.22-83.18,163.77-60.13,117.96-120.27,235.9-180.47,353.82-33.79,66.18-67.37,132.47-101.61,198.42-53.28,102.65-107.01,205.06-160.6,307.55-55.52,106.2-110.94,212.46-166.69,318.54-53.32,101.45-107.16,202.63-160.48,304.07-26.05,49.56-51.46,99.46-77.17,149.2-1.92,3.72-3.71,7.53-5.97,11.04-7.19,11.17-18.8,15.28-31.33,10.86-4.9-1.73-9.59-4.21-14.15-6.75-34.31-19.07-68.52-38.3-102.83-57.35-112.56-62.48-225.13-124.94-337.77-187.29-10.52-5.82-21.43-10.97-32.33-16.07-19.62-9.18-20.42-9.01-35.38,5.71-6.71,6.61-13.24,13.4-19.74,20.23-73.21,76.99-146.46,153.95-219.58,231.03-58.35,61.51-116.55,123.18-174.82,184.77-1.8,1.9-3.74,3.67-5.51,5.59-5.03,5.44-11.13,7.57-18.44,6.21-1.03-.19-2.08-.27-3.11-.43-27.9-4.36-27.8-7.84-34.4-28-15.95-48.72-31.72-97.53-46.32-146.67-29.67-99.81-58.98-199.72-87.56-299.84-24.27-85.02-47.28-170.4-70.9-255.61-6.99-25.21-14.45-50.29-21.08-75.6-2.63-10.04-8.11-16.15-17.53-20.33-43.04-19.11-85.66-39.18-128.84-57.97-124.26-54.1-248.71-107.78-373.12-161.56-36.98-15.99-74.13-31.6-111.07-47.69-12.94-5.64-25.83-11.56-38.11-18.47-15.8-8.89-23.1-30.65-17.21-47.65,1.85-5.34,5.65-8.87,10.52-11.06,10.49-4.7,20.98-9.5,31.77-13.44,53.57-19.58,107.29-38.73,160.85-58.33,78.62-28.77,157.17-57.73,235.71-86.71,98.18-36.23,196.39-72.38,294.46-108.89,132.9-49.47,265.68-99.25,398.51-148.87,90.68-33.88,181.55-67.26,272.02-101.69,111.5-42.43,222.85-85.26,333.94-128.77,139.34-54.58,278.22-110.35,417.54-164.99,126.17-49.48,252.57-98.34,379.04-147.05,100.59-38.74,201.38-76.96,302.16-115.18,43.54-16.51,87.3-32.45,130.97-48.64,2.45-.91,4.96-1.69,7.39-2.64,12.61-4.92,20.68,1.86,24.73,10.18,2.46,5.05,3.42,10.82,5.08,16.35ZM1972.75,1034.58c-6.97-.26-10.29,3.42-13.96,6.12-15.61,11.46-31.18,22.97-46.64,34.64-95.68,72.2-191.35,144.41-286.99,216.67-130.3,98.45-260.57,196.94-390.83,295.44-26.72,20.2-53.38,40.49-79.98,60.85-3.1,2.37-7.73,3.96-6.77,10.05,4.12,4.3,10.09,6.54,15.6,9.35,87.68,44.65,175.44,89.15,263.11,133.82,88.6,45.14,177.11,90.47,265.7,135.64,96.52,49.22,193.06,98.39,289.65,147.46,13.06,6.63,26.37,12.8,39.75,18.76,8.21,3.65,10.68,3.07,15.83-4.6,6.11-9.09,11.96-18.47,16.82-28.27,25.59-51.58,49.25-104.06,71.81-157.03,1.43-3.37,2.55-6.86,3.95-10.25,3.29-7.95,4.18-16.19,2.88-24.64-1.74-11.38-3.35-22.78-5.47-34.09-7.11-38.06-14.46-76.08-21.64-114.14-10.18-54-20.25-108.01-30.42-162.01-9.59-50.91-19.29-101.8-28.85-152.72-7.53-40.12-14.86-80.27-22.39-120.39-6.75-36-13.57-72-20.49-107.97-9.29-48.3-18.68-96.58-28.1-144.86-.49-2.49-1.58-4.86-2.58-7.83ZM3025.74,211.78c-2.58,1.57-5.28,2.9-7.62,4.69-7.07,5.4-13.97,11.02-21,16.48-69.89,54.22-139.84,108.37-209.69,162.63-64.48,50.09-128.83,100.37-193.33,150.44-106.26,82.49-212.48,165.03-318.94,247.26-72.91,56.31-146.22,112.11-219.31,168.18-9.13,7.01-17.89,14.52-27.11,21.4-6.65,4.96-8.81,10.77-7.32,19.04,3.91,21.63,7.14,43.38,10.7,65.07,12.54,76.43,25.17,152.85,37.63,229.29,10.19,62.5,20.21,125.02,30.26,187.54,8.56,53.22,16.86,106.49,25.64,159.67,8.7,52.67,17.8,105.27,26.87,157.87,1.69,9.79,3.97,19.48,6.2,29.17.54,2.35,1.05,5.27,5.33,5.46,4.88-3.53,7.09-9.56,10.02-14.94,27.82-51,55.74-101.94,83.2-153.13,39.58-73.79,78.74-147.81,118.17-221.68,31.79-59.56,63.88-118.96,95.57-178.57,76.66-144.18,153.28-288.37,229.69-432.68,48.24-91.11,96.01-182.48,144.12-273.67,37.11-70.36,74.44-140.6,111.63-210.92,22.51-42.56,44.99-85.14,67.37-127.77,1.57-2.99,4.89-5.86,1.91-10.83ZM1806.29,935.01c-2.24-1.24-5.29-1.21-8.34-1.13-17.26.5-34.54.69-51.79,1.58-79.44,4.1-158.88,8.31-238.3,12.65-67.93,3.71-135.86,7.62-203.78,11.47-21.42,1.21-42.86,2.21-64.26,3.8-66.28,4.91-132.53,10.34-198.82,15-37.84,2.66-74.56,9.83-110.35,22.51-44.38,15.73-89.1,30.51-133.55,46.02-112.63,39.31-225.22,78.71-337.77,118.26-61.7,21.68-123.28,43.71-184.91,65.6-12.82,4.55-25.62,9.15-38.4,13.82-3.35,1.22-7.1,2.2-7.68,7.82,2.68,1.56,5.53,3.66,8.7,4.98,26.57,11.06,53.18,22.02,79.81,32.93,150.59,61.68,301.2,123.28,451.76,185.02,30.98,12.7,61.92,25.55,92.57,39.01,9.69,4.25,17.69,3.83,26.45-1.8,12.32-7.91,25.26-14.85,37.72-22.56,91.23-56.44,182.47-112.87,273.58-169.49,109.78-68.23,219.53-136.5,329.13-205.03,74.99-46.89,149.69-94.23,224.5-141.39,16.38-10.33,32.71-20.73,48.98-31.23,2.38-1.54,6.06-2.54,4.77-7.83ZM2900.67,241.64c-5.01.75-8.83,1.86-12.59,3.29-42.04,16.04-84.23,31.72-126.1,48.2-70.12,27.59-140.04,55.66-210.04,83.56-62.7,25-125.44,49.92-188.07,75.09-54.38,21.85-108.62,44.04-162.97,65.99-84.91,34.29-169.8,68.65-254.81,102.69-88.41,35.41-176.78,70.95-265.51,105.54-79.95,31.17-160.25,61.47-240.63,91.52-99,37.02-198.25,73.37-297.36,110.08-7.35,2.72-14.55,5.87-21.74,8.99-2.4,1.04-4.62,2.6-2.37,6.84,5.17.11,10.88.52,16.56.29,28.76-1.17,57.54-2.04,86.26-3.87,69.47-4.43,138.94-9.03,208.36-14.12,102.31-7.49,204.58-15.54,306.88-23.19,44.36-3.32,88.75-6.32,133.14-9.27,8.07-.54,15.11-2.91,21.98-7.27,28.27-17.96,56.82-35.48,85.2-53.27,73.17-45.86,146.41-91.62,219.43-137.72,70.36-44.42,140.46-89.27,210.72-133.85,50.82-32.25,101.85-64.17,152.54-96.6,59.51-38.08,118.76-76.58,178.14-114.87,50.15-32.33,100.34-64.58,150.46-96.95,4.26-2.75,9.44-4.56,12.54-11.11ZM1032.94,2131.84c.33,3.79.34,7.4,1.01,10.89,7.89,41.64,15.63,83.32,23.97,124.88,3.08,15.37,7.42,30.5,11.62,45.62,1.23,4.41,3.75,8.52,6.04,12.56,1.15,2.03,5.83,1.97,6.89-.02,1.7-3.19,3.54-6.49,4.28-9.97,1.94-9.21,3.78-18.48,4.84-27.81,7.24-63.96,14.33-127.93,21.34-191.91,4.67-42.65,9.02-85.34,13.71-128,2.74-24.97,5.77-49.91,8.84-74.84,5.38-43.62,10.85-87.24,16.38-130.84.66-5.18,1.8-10.31,2.97-15.41,2.7-11.74,5.94-13.45,17.81-9.37,4.45,1.53,8.81,3.34,13.11,5.25,32.55,14.38,65.17,28.6,97.57,43.3,36.22,16.42,72.23,33.31,108.35,49.94,3.46,1.59,6.87,3.72,14.69,3.69-9.58-6.16-15.98-10.6-22.69-14.53-38.36-22.52-76.63-45.19-115.22-67.29-40.87-23.41-82.06-46.25-123.13-69.29-2.72-1.53-5.59-2.89-8.52-3.94-3.88-1.38-7.21.67-8.23,4.87-.49,2.03-.8,4.11-.99,6.19-1.18,12.5-2.47,25-3.4,37.53-3.17,42.27-6.16,84.56-9.3,126.83-6.56,88.2-13.09,176.41-19.8,264.6-2.26,29.74-4.16,59.53-9.91,88.88-1.1,5.63-2.34,11.3-4.26,16.68-.73,2.04-3.45,4.47-5.45,4.66-1.98.19-5.26-1.72-6.15-3.58-3.36-7.05-6.41-14.32-8.79-21.76-7.49-23.42-14.61-46.95-21.94-70.42-.87-2.77-.66-6.42-5.64-7.38ZM1862.74,1058.32c.82-.04,1.64-.08,2.46-.12.63-1.34,1.7-2.65,1.82-4.04,3.36-39.99,6.65-80,9.86-120,.16-1.98-.47-4.02-.75-6.11-8.12-2.36-13.3,2.41-18.43,6.63-4.28,3.52-2.67,8.59-2.38,13.2,2.12,33.82,4.24,67.64,6.39,101.45.19,3.01.67,5.99,1.02,8.99Z"/>
      <path d="M1668.27,1320.45c-9.51,8.09-18.93,16.3-28.56,24.26-81.09,67.04-162.19,134.05-243.35,201.01-35.53,29.31-71.19,58.46-106.75,87.74-6.46,5.32-12.74,10.87-19.04,16.39-4.38,3.83-9.31,4.88-14.55,2.47-6.03-2.78-12.9-4.47-16.77-11.2,1.26-6.36,6.53-9.34,10.91-12.75,12.8-9.97,25.83-19.64,38.79-29.41,65.21-49.14,130.34-98.39,195.68-147.36,54.87-41.12,109.97-81.92,165.01-122.82,5.34-3.97,10.58-8.2,16.74-10.84.63.84,1.26,1.68,1.89,2.52Z"/>
      <path d="M1291.65,1667.54c3.48-3.61,6.01-6.91,9.17-9.42,34.81-27.7,71.39-52.87,109.32-76.08,2.08-1.27,4.34-3.2,8.05-.55-2.13,2.71-3.91,5.67-6.33,7.96-20.82,19.82-41.8,39.48-62.64,59.27-9.85,9.36-19.58,18.85-29.26,28.38-3.41,3.36-7.01,4.22-11.34,2.06-5.53-2.76-11.63-4.63-16.98-11.63Z"/>
      <path d="M1351.03,1697.11c.6-6.3,4.75-8.85,8.55-11.31,8.94-5.77,17.3-12.82,27.22-15.24,3.5,2.32,2.8,4.43,1.71,6.12-5.32,8.22-10.84,16.31-16.22,24.5-2.27,3.45-5.21,4.83-9.23,3.56-4.44-1.41-8.87-2.86-12.04-7.64Z"/>
      <path d="M2617.05,926.17c-2.58,3.86-5.47,7.55-7.69,11.61-45.86,84.01-91.43,168.17-137.51,252.07-31.47,57.3-63.65,114.22-95.46,171.34-40.2,72.2-80.28,144.47-120.51,216.65-17.57,31.52-35.38,62.91-53.11,94.34-2.05,3.64-4.05,7.37-6.61,10.64-1.44,1.83-3.99,2.79-6.61,4.51-6.14-10.33-9.24-20.8-9.91-31.69-.26-4.24,2.25-9.04,4.51-12.99,14.04-24.51,28.24-48.92,42.61-73.24,44.45-75.19,88.87-150.4,133.53-225.47,41.18-69.22,82.48-138.38,124.07-207.37,39.16-64.95,78.75-129.63,118.18-194.42,2.45-4.02,4.82-8.14,7.77-11.77,1.5-1.85,4.21-2.73,6.37-4.04,0,0,.36-.19.36-.19Z"/>
      <path d="M2840.48,490.59c-.7-5,2.07-9.03,3.35-13.33,1.35-4.5,3-8.92,4.55-13.36,1.71-4.94,3.42-9.88,5.19-14.8,1.59-4.43,3.39-8.79,4.87-13.25,1.46-4.41,2.65-8.91,3.83-12.93-2.62-3.37-5.2-2.49-7.37-1.03-5.2,3.5-10.36,7.1-15.29,10.97-85.59,67.19-173.36,131.49-260.51,196.62-18.43,13.78-37.08,27.27-55.67,40.84-3.31,2.42-6.81,4.58-10.41,6.98-1.8-4.07,1.54-5.04,3.14-6.39,19.15-16.23,38.31-32.45,57.72-48.37,86.14-70.65,172.38-141.19,258.55-211.81,20.23-16.58,40.26-33.39,60.52-49.93,4.42-3.61,9.24-6.85,14.21-9.66,3.89-2.19,9.25,1.84,8.19,6.11-1.12,4.51-2.72,9.03-4.87,13.15-7.24,13.92-14.64,27.75-22.29,41.45-13.26,23.74-26.73,47.37-40.17,71.01-1.7,2.99-2.33,7.09-7.54,7.73Z"/>
      <path d="M2310.12,1337.79c-3.84,7.93-7.6,15.91-11.54,23.79-35.29,70.63-74.15,139.33-112.97,208.05-2.82,4.99-6.05,9.78-9.42,14.42-1.07,1.48-3.22,2.18-5.59,3.7-5.43-10-7.97-20.13-8.79-30.39-.33-4.11,2.56-8.92,5.02-12.74,19.27-29.86,38.71-59.62,58.26-89.3,20.13-30.56,40.4-61.02,60.71-91.45,5.22-7.82,10.75-15.44,16.3-23.04,1.44-1.97,3.48-3.49,5.24-5.21.92.73,1.85,1.45,2.77,2.18Z"/>
      <path d="M2616.69,926.35c-.18-.73-.36-1.46-.53-2.18-.06.36-.27.8-.14,1.07.18.38.62.63.99.93.04,0-.32.18-.32.18Z"/>
      <path d="M1418.27,1115.5c-2.43,6.54-8.94,8.39-14,11.63-25.99,16.63-52.2,32.92-78.33,49.32-89.93,56.44-179.73,113.07-269.82,169.25-63.02,39.29-126.31,78.16-189.73,116.79-20.18,12.3-15.73,12.7-38.7,2.24-36.64-16.68-72.82-34.36-109.14-51.74-2.62-1.25-6.17-2-6.58-6.12,4.12-2.74,7.96-.18,11.69.94,33.56,10.07,67.07,20.28,100.6,30.46,2,.61,4.05,1.11,5.97,1.92,9.93,4.16,18.71,2.68,28.13-2.9,41.85-24.78,84.09-48.9,126.17-73.28,84.17-48.77,168.29-97.61,252.5-146.31,54.78-31.68,109.66-63.18,164.56-94.66,5.33-3.06,10.15-7.6,17-7.2l-.32-.36Z"/>
      <path d="M538.43,1337.39c-6.88-2.09-13.81-4.04-20.64-6.3-62.51-20.7-124.25-43.5-185.29-68.18-4.83-1.95-9.67-4.05-14.09-6.76-5.51-3.36-5.02-9.58,1.1-12.03,12.6-5.04,25.25-10.13,38.21-14.1,54.94-16.83,110-33.29,165.04-49.79,5.87-1.76,11.94-2.86,19.39-4.61-2.75,6.57-7.72,7.53-11.58,9.2-34.03,14.73-68.15,29.28-102.35,43.62-12.04,5.05-24.43,9.23-36.58,14.03-4.26,1.68-8.25,4.03-13.78,6.77,3.05,3.14,4.66,5.88,7.05,7.06,11.23,5.57,22.77,10.51,34.03,16.03,31.91,15.63,63.77,31.35,95.56,47.21,8.76,4.37,17.39,9.08,25.32,14.83-.47,1.01-.93,2.02-1.4,3.03Z"/>
      <path d="M884.37,1375.69c-1,2.43-1.17,4.26-2.15,5.01-11.13,8.52-22.19,17.14-33.67,25.15-6.56,4.57-11.21,3.32-16.21-2.76-2.17-2.65-1.88-6.24,1.03-8.08,3.05-1.93,6.26-3.72,9.6-5.08,11.55-4.68,23.16-9.19,34.81-13.61,1.72-.65,3.77-.4,6.59-.64Z"/>
      <path d="M440.06,1251.69c2.04-5.11,6.9-5.6,11.38-6.73q11.23-2.82,20.07-.5c-3.72,6.73-9.02,11.48-15.28,15-1.96,1.1-5.18.92-7.49.24-3.94-1.17-7.83-2.98-8.68-8.01Z"/>
      <path d="M1418.59,1115.86c1.26-1.28,2.45-2.63,3.83-3.76.21-.17,1.3.67,1.89,1.15.07.06-.32,1.08-.62,1.15-1.79.45-3.61.75-5.42,1.1,0,0,.31.35.31.35Z"/>
      <path d="M2411.9,516.88c-17.12,15.45-301.17,185.62-420.95,252.4-19.38,10.81-38.14,22.92-59.78,30.08,1.68-1.64,3.19-3.51,5.06-4.88,144.65-106.12,299.41-195.11,461.26-272.07,4.07-1.93,8.03-4.14,14.41-5.52Z"/>
      <path d="M1362.84,874.69c-1.53,4.09-2.58,6.93-3.69,9.88,2.75,4.64,7.22,4.04,11.18,4.23,17.76.86,35.54,1.48,53.3,2.38,5.1.26,10.16,1.15,18.14,2.09-7.91,4.21-13.59,4.71-19.15,5.38-41.53,5.07-83.06,10.26-124.64,14.93-11.92,1.34-24.01,1.27-36.03,1.46-2.75.04-5.53-1.52-8.31-2.35,1.53-6.75,6.81-7.36,10.83-9.19,31.07-14.12,81.21-28.92,98.36-28.8Z"/>
      <path d="M1531.48,817.33c1.15-4.67,5.3-5,8.35-6.5,66.73-32.77,136.79-56.7,209.64-79.52-1.7,2.97-2.03,4.49-2.91,4.95-48.73,25.22-97.44,50.53-150.29,66.37-17.51,5.25-35.27,9.65-53,14.13-3.68.93-7.67,3.03-11.79.58Z"/>
    </g>
  </g>
</svg>  
  <div class="bgelms">
    <div class="bgelm compass"></div>
    <div class="bgelm octopus"></div>
    <div class="bgelm boat"></div>
    <div class="sigelm"></div>
    </div>

    {%- if settings.cart_type == 'drawer' -%}
      {%- render 'cart-drawer' -%}
    {%- endif -%}

    {% sections 'header-group' %}

    <main id="MainContent" class="content-for-layout focus-none" role="main" tabindex="-1">
      {{ content_for_layout }}
    </main>

    <ul hidden>
      <li id="a11y-refresh-page-message">{{ 'accessibility.refresh_page' | t }}</li>
      <li id="a11y-new-window-message">{{ 'accessibility.link_messages.new_window' | t }}</li>
    </ul>

    <script>
      window.shopUrl = '{{ request.origin }}';
      window.routes = {
        cart_add_url: '{{ routes.cart_add_url }}',
        cart_change_url: '{{ routes.cart_change_url }}',
        cart_update_url: '{{ routes.cart_update_url }}',
        cart_url: '{{ routes.cart_url }}',
        predictive_search_url: '{{ routes.predictive_search_url }}',
      };

      window.cartStrings = {
        error: `{{ 'sections.cart.cart_error' | t }}`,
        quantityError: `{{ 'sections.cart.cart_quantity_error_html' | t: quantity: '[quantity]' }}`,
      };

      window.variantStrings = {
        addToCart: `{{ 'products.product.add_to_cart' | t }}`,
        soldOut: `{{ 'products.product.sold_out' | t }}`,
        unavailable: `{{ 'products.product.unavailable' | t }}`,
        unavailable_with_option: `{{ 'products.product.value_unavailable' | t: option_value: '[value]' }}`,
      };

      window.quickOrderListStrings = {
        itemsAdded: `{{ 'sections.quick_order_list.items_added.other' | t: quantity: '[quantity]' }}`,
        itemAdded: `{{ 'sections.quick_order_list.items_added.one' | t: quantity: '[quantity]' }}`,
        itemsRemoved: `{{ 'sections.quick_order_list.items_removed.other' | t: quantity: '[quantity]' }}`,
        itemRemoved: `{{ 'sections.quick_order_list.items_removed.one' | t: quantity: '[quantity]' }}`,
        viewCart: `{{- 'sections.quick_order_list.view_cart' | t -}}`,
        each: `{{- 'sections.quick_order_list.each' | t: money: '[money]' }}`,
        min_error: `{{- 'sections.quick_order_list.min_error' | t: min: '[min]' }}`,
        max_error: `{{- 'sections.quick_order_list.max_error' | t: max: '[max]' }}`,
        step_error: `{{- 'sections.quick_order_list.step_error' | t: step: '[step]' }}`,
      };

      window.accessibilityStrings = {
        imageAvailable: `{{ 'products.product.media.image_available' | t: index: '[index]' }}`,
        shareSuccess: `{{ 'general.share.success_message' | t }}`,
        pauseSlideshow: `{{ 'sections.slideshow.pause_slideshow' | t }}`,
        playSlideshow: `{{ 'sections.slideshow.play_slideshow' | t }}`,
        recipientFormExpanded: `{{ 'recipient.form.expanded' | t }}`,
        recipientFormCollapsed: `{{ 'recipient.form.collapsed' | t }}`,
        countrySelectorSearchCount: `{{ 'localization.country_results_count' | t: count: '[count]' }}`,
      };
    </script>

    {%- if settings.predictive_search_enabled -%}
      <script src="{{ 'predictive-search.js' | asset_url }}" defer="defer"></script>
    {%- endif -%}

    {%- if settings.cart_type == 'drawer' -%}
      <script src="{{ 'cart-drawer.js' | asset_url }}" defer="defer"></script>
    {%- endif -%}

    {% sections 'footer-group' %}

    <script>
(() => {
  const container = document.getElementById('ou-reviews');
  const jsonEl = document.getElementById('shop-reviews-data');
  if (!container || !jsonEl) return;

  let reviews = [];
  try {
    reviews = JSON.parse(jsonEl.textContent || '[]') || [];
  } catch(e) {
    console.warn('Invalid shop reviews JSON', e);
    return;
  }

  // Read controls
  const indicesStr = (container.dataset.indices || '').replace(/\s+/g, '');
  const count = parseInt(container.dataset.count || '4', 10);
  const random = (container.dataset.random || 'true') === 'true';
  const minRating = parseInt(container.dataset.minRating || '0', 10);

  // Filter by rating
  const eligible = reviews
    .map((r, i) => ({...r, _i: i}))
    .filter(r => (parseInt(r.rating || 0, 10) >= minRating));

  // Pick indexes
  let picked = [];
  if (indicesStr) {
    // explicit 1-based → 0-based
    const wanted = indicesStr.split(',').map(n => parseInt(n, 10) - 1);
    picked = wanted
      .filter(i => i >= 0 && i < reviews.length)
      .map(i => ({...reviews[i], _i: i}));
  } else {
    let pool = [...eligible];
    if (random) {
      for (let i = pool.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [pool[i], pool[j]] = [pool[j], pool[i]];
      }
    }
    picked = pool.slice(0, Math.max(0, count));
  }

  if (!picked.length) {
    container.innerHTML = '<p>No reviews matched.</p>';
    return;
  }

  // Render
  const starHTML = (n) => {
    const rating = Math.max(0, Math.min(5, parseInt(n || 0, 10)));
    let s = '';
    for (let i = 1; i <= 5; i++) s += `<span class="ou-star${i <= rating ? ' is-filled' : ''}" ><svg width="24" height="23" viewBox="0 0 24 23" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.5906 14.0532L19.4195 22.7302L12 17.3874L4.67114 22.7603L7.45973 14.0632L0 8.69035H9.19127L12 0.0234375L14.8087 8.71044H24L16.5906 14.0532Z" fill="#A30000"/>
</svg>
</span>`;
    return `<div class="ou-review__stars" aria-label="${rating} out of 5">${s}</div>`;
  };

  const escapeHTML = (str) => String(str || '')
    .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');

  container.innerHTML = picked.map(r => `
    <article class="ou-review" itemscope itemtype="https://schema.org/Review">
      ${r.rating ? `<div itemprop="reviewRating" itemscope itemtype="https://schema.org/Rating">
          <meta itemprop="worstRating" content="1"><meta itemprop="bestRating" content="5">
          <meta itemprop="ratingValue" content="${parseInt(r.rating,10)}">
          ${starHTML(r.rating)}
        </div>` : ''}
      ${r.text ? `<blockquote class="ou-review__text" itemprop="reviewBody">${escapeHTML(r.text)}</blockquote>` : ''}
      ${r.author ? `<p class="ou-review__meta"><span itemprop="author">${escapeHTML(r.author)}</span></p>` : ''}
    </article>
  `).join('');
})();

(() => {
  const INTERVAL_MS = 300;

  document.querySelectorAll('.shuffle').forEach(initShuffle);

  function initShuffle(container) {
    // Ensure there's an active item; default to first child
    if (!container.querySelector('.active') && container.firstElementChild) {
      container.firstElementChild.classList.add('active');
    }

    // Store the timer id on the element so multiple shuffles can coexist
    container._shuffleTimer = null;

    container.addEventListener('mouseenter', () => start(container));
    container.addEventListener('mouseleave', () => stop(container));
  }

  function start(container) {
    if (container._shuffleTimer) return; // already running

    // Advance immediately on hover-in, then start interval
    step(container);
    container._shuffleTimer = setInterval(() => step(container), INTERVAL_MS);
  }

  function stop(container) {
    if (!container._shuffleTimer) return;
    clearInterval(container._shuffleTimer);
    container._shuffleTimer = null; // keep current active, just pause
  }

  function step(container) {
    const items = Array.from(container.children);
    if (!items.length) return;

    let idx = items.findIndex(el => el.classList.contains('active'));
    if (idx < 0) idx = 0; // fallback

    items[idx].classList.remove('active');
    items[(idx + 1) % items.length].classList.add('active');
  }
})();
</script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  // Only run this behaviour on touch devices
  var isTouch = window.matchMedia('(hover: none)').matches || 'ontouchstart' in window;
  if (!isTouch) return;

  let activeCard = null; // track which card is flipped

  document.querySelectorAll('.flip-card').forEach(function(card) {
    card.addEventListener('click', function(e) {

      // If clicking a different card, reset the previous one
      if (activeCard && activeCard !== card) {
        activeCard.classList.remove('is-flipped');
        activeCard = null;
      }

      const isFlipped = card.classList.contains('is-flipped');

      if (!isFlipped) {
        // First tap on this card → flip it
        e.preventDefault();
        card.classList.add('is-flipped');
        activeCard = card;
      } else {
        // Second tap → follow the link
        e.preventDefault();
        window.location.href = card.getAttribute('href');
      }

    });
  });
});

// Change this to whatever your hamburger button uses
// e.g. '.header__icon--menu', '.js-mobile-nav-toggle', '[data-menu-toggle]'
const TOGGLE_SELECTOR = '.header__hamburger';

const header2 = document.querySelector('.section-header');

if (header2) {
  const inner = header2.firstElementChild || header2;
  const triggerY = inner.getBoundingClientRect().top + window.scrollY;

  // Find the original hamburger toggle inside the normal header
  const originalToggle = header2.querySelector(TOGGLE_SELECTOR);

  // Clone the header for the fixed version
  const fixedHeader = header2.cloneNode(true);
  fixedHeader.classList.add('section-header-fixed');
  fixedHeader.setAttribute('aria-hidden', 'true'); // optional

  document.body.appendChild(fixedHeader);

  // Find the cloned hamburger button inside the fixed header
  const clonedToggle = fixedHeader.querySelector(TOGGLE_SELECTOR);

  // Wire cloned hamburger to trigger the original one
  if (originalToggle && clonedToggle) {
    clonedToggle.addEventListener('click', (e) => {
      e.preventDefault();
      originalToggle.click(); // reuse theme's existing JS
    });
  }

  let lastScrollY = window.scrollY;
  let ticking = false;

  function updateHeader(scrollY) {
    const shouldShow = scrollY >= triggerY;
    fixedHeader.classList.toggle('is-visible', shouldShow);
  }

  window.addEventListener('scroll', () => {
    lastScrollY = window.scrollY;

    if (!ticking) {
      window.requestAnimationFrame(() => {
        updateHeader(lastScrollY);
        ticking = false;
      });
      ticking = true;
    }
  });

  // Run once on load
  updateHeader(window.scrollY);
}




</script>



  </body>
</html>


